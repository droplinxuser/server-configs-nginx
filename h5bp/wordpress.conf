

location / {
  limit_except GET POST { deny all; }
  try_files $uri $uri/ /index.php?$args;
  }

location ~* ^/(?:xmlrpc\.php|wp-links-opml\.php|wp-config\.php|wp-config-sample\.php|wp-comments-post\.php|readme\.html|license\.txt)$ { internal; }
location ~* ^.+\.(bak|log|old|orig|original|php#|php~|php_bak|save|swo|swp|sql)$ { internal; }
location ~* /(wp-config.php|wp-config.txt|readme.html|license.txt|nginx.conf)    { internal; }
location ~* /(?:uploads|files|wp-content|wp-includes|akismet)/.*.php$            { internal; }
location ~* ^/(wp-content)/(.*?)\.(zip|gz|tar|bzip2|7z)\$                        { internal; }
location ~ ^/wp-content/uploads/sucuri                                           { internal; }
location ~ ^/wp-content/updraft                                                  { internal; }
location ~* .(pl|cgi|py|sh|lua|asp)$                                             { internal; }
location ~* ^/wp-content/plugins/.+\.(txt|log|md)$                               { internal; }
location ~* ^/wp-content/themes/.+\.(txt|log|md)$                                { internal; }
location ~* ^/wp-content/uploads/.*.(html|htm|shtml|php|js|swf)$                 { internal; }
location ~* ^/(?:wp-content|wp-includes)/.*\.php$                                { internal; }

location ^~ /wp-admin/install.php       { internal; }
location ^~ /wp-admin/upgrade.php       { internal; }
location ~* /(?:uploads|files)/.*\.php$ { internal; }

location ~ ^/xmlrpc.php   { internal; }
location ~ /\.(svn|git)/* { internal; }
location ~ /\.ht          { internal; }
location ~ /\.user.ini    { internal; }

location ~* "(eval\()"                  { internal; }
location ~* "(127\.0\.0\.1)"            { internal; }
location ~* "([a-z0-9]{2000})"          { internal; }
location ~* "(javascript\:)(.*)(\;)"    { internal; }
location ~* "(base64_encode)(.*)(\()"   { internal; }
location ~* "(GLOBALS|REQUEST)(=|\[|%)" { internal; }
location ~* "(<|%3C).*script.*(>|%3)"   { internal; }
location ~ "(\\|\.\.\.|\.\./|~|`|<|>|\|)"                           { internal; }
location ~* "(boot\.ini|etc/passwd|self/environ)"                   { internal; }
location ~* "(thumbs?(_editor|open)?|tim(thumb)?)\.php"             { internal; }
location ~* "(\'|\")(.*)(drop|insert|md5|select|union)"             { internal; }
location ~* "(https?|ftp|php):/"                                    { internal; }
location ~* "(=\\\'|=\\%27|/\\\'/?)\."                              { internal; }
location ~ "(\{0\}|\(/\(|\.\.\.|\+\+\+|\\\"\\\")"                   { internal; }
location ~ "(~|`|<|>|:|;|%|\\|\s|\{|\}|\[|\]|\|)"                   { internal; }
location ~* "/(=|\$&|_mm|(wp-)?config\.|cgi-|etc/passwd|muieblack)" { internal; }
location ~* "(&pws=0|_vti_|\(null\)|\{\$itemURL\}|echo(.*)kae|etc/passwd|eval\(|self/environ)"                                       { internal; }
location ~* "/(^$|mobiquo|phpinfo|shell|sqlpatch|thumb|thumb_editor|thumbopen|timthumb|webshell|config|settings|configuration)\.php" { internal; }
